generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model User {
  id    String @id @default(cuid())
  name  String
  email String @unique
}

model Product {
  id              String        @id @default(uuid())
  code            String        @unique // 4 digit alfanumerik uppercase (PRD1, DRES2, dll)
  name            String
  description     String?
  modalAwal       Decimal       @db.Decimal(10, 2) // Biaya pembuatan baju
  hargaSewa       Decimal       @db.Decimal(10, 2) // Harga sewa per sekali
  quantity        Int
  imageUrl        String?
  categoryId      String
  category        Category      @relation(fields: [categoryId], references: [id])
  size            String?       // Ukuran: S, M, L, XL, XXL atau custom
  colorId         String?       // Relasi ke Color model
  color           Color?        @relation(fields: [colorId], references: [id])
  status          ProductStatus @default(AVAILABLE)
  totalPendapatan Decimal       @db.Decimal(10, 2) @default(0) // Pendapatan kumulatif
  isActive        Boolean       @default(true)
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt
  createdBy       String        // User ID dari Clerk

  @@index([isActive])
  @@index([categoryId])
  @@index([status])
  @@index([createdBy])
  @@index([size])
  @@index([colorId])
  @@index([categoryId, size, colorId])
}

model Category {
  id        String    @id @default(uuid())
  name      String    @unique
  color     String    // Hex color untuk badge
  products  Product[]
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  createdBy String    // User ID dari Clerk

  @@index([createdBy])
}

model Color {
  id          String    @id @default(uuid())
  name        String    @unique
  hexCode     String?   // Hex color code (optional)
  description String?   // Deskripsi warna (optional)
  isActive    Boolean   @default(true)
  products    Product[]
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  createdBy   String    // User ID dari Clerk

  @@index([createdBy])
  @@index([isActive])
  @@map("colors")
}

enum ProductStatus {
  AVAILABLE    // Tersedia
  RENTED       // Disewa
  MAINTENANCE  // Maintenance
}
